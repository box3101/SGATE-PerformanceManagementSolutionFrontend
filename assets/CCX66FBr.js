import T from"./BA8dV_WE.js";import{_ as K,r as k,z as h,P as W,c as a,o as s,a as n,b as d,k as p,t as f,m as _,x as G,d as P,F as D,g as I}from"./_dJCav7h.js";const q={class:"ui-attachment"},H={class:"attachment-section"},J={class:"section-header flex items-center gap-5"},Q={class:"section-title"},X={key:0,class:"image-count-badge"},Y={class:"section-content"},Z={class:"file-upload-container"},ee={for:"file-upload",class:"file-upload-label"},te={key:0,class:"file-info"},ne={class:"file-info-text"},ie={key:1},le={class:"file-info-text"},ae={key:0,class:"image-preview-section"},se={class:"preview-header"},oe={class:"image-preview-grid"},re=["src","alt"],ce={class:"image-overlay"},de=["onClick"],ue={key:1,class:"non-image-files"},me={class:"file-info-section"},pe={class:"file-name"},fe={class:"file-size"},ve=["onClick"],ge={__name:"UiAttachment",props:{title:{type:String,default:"파일첨부"},modelValue:{type:Array,default:()=>[]},icon:{type:String,default:"mdi:paperclip"},showNonImageFiles:{type:Boolean,default:!0}},emits:["update:modelValue","file-added","file-removed","files-cleared"],setup(c,{emit:L}){const u=c,m=L,v=k(!1),g=k(0),o=k(new Map),y=h(()=>u.modelValue.map((e,t)=>({file:e,originalIndex:t})).filter(({file:e})=>z(e))),w=h(()=>u.modelValue.map((e,t)=>({file:e,originalIndex:t})).filter(({file:e})=>!z(e))),F=h(()=>y.value.length>0),U=h(()=>u.modelValue.reduce((t,i)=>t+i.size,0).toLocaleString());function z(e){return e.type.startsWith("image/")}function B(e){return e.type.startsWith("image/")?"mdi:image":e.type.startsWith("video/")?"mdi:video":e.type.includes("pdf")?"mdi:file-pdf-box":e.type.includes("excel")||e.type.includes("spreadsheet")?"mdi:file-excel":e.type.includes("word")||e.type.includes("document")?"mdi:file-word":e.type.includes("powerpoint")||e.type.includes("presentation")?"mdi:file-powerpoint":e.type.includes("zip")||e.type.includes("rar")||e.type.includes("7z")?"mdi:archive":"mdi:file"}function M(e){if(e===0)return"0 Bytes";const t=1024,i=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,l)).toFixed(2))+" "+i[l]}function S(e){const t=`${e.name}-${e.size}-${e.lastModified}`;if(!o.value.has(t)){const i=URL.createObjectURL(e);o.value.set(t,i)}return o.value.get(t)}function C(e){e.target.classList.add("loaded")}function R(e){console.warn("이미지 로드 실패:",e.target.src),e.target.style.display="none"}function $(e){const t=Array.from(e.target.files);V(t),e.target.value=""}function j(e){e.preventDefault(),v.value=!0}function E(e){e.preventDefault(),g.value++,v.value=!0}function A(e){e.preventDefault(),g.value--,g.value===0&&(v.value=!1)}function N(e){e.preventDefault(),v.value=!1,g.value=0;const t=Array.from(e.dataTransfer.files);V(t)}function V(e){if(e.length===0)return;const i=[...[...u.modelValue],...e];if(i.length>5){alert("최대 5개 파일까지만 업로드 가능합니다.");return}if(i.reduce((r,x)=>r+x.size,0)>52428800){alert("총 파일 크기는 50MB를 초과할 수 없습니다.");return}m("update:modelValue",i),m("file-added",e)}function b(e){const t=u.modelValue[e];if(z(t)){const l=`${t.name}-${t.size}-${t.lastModified}`,r=o.value.get(l);r&&(URL.revokeObjectURL(r),o.value.delete(l))}const i=[...u.modelValue];i.splice(e,1),m("update:modelValue",i),m("file-removed",t)}function O(){confirm("모든 파일을 삭제하시겠습니까?")&&(o.value.forEach(e=>URL.revokeObjectURL(e)),o.value.clear(),m("update:modelValue",[]),m("files-cleared"))}return W(()=>{o.value.forEach(e=>{URL.revokeObjectURL(e)}),o.value.clear()}),(e,t)=>{const i=T;return s(),a("div",q,[n("div",H,[n("div",J,[d(i,{name:c.icon,size:"24",class:"section-icon"},null,8,["name"]),n("span",Q,f(c.title),1),F.value?(s(),a("span",X," 이미지 "+f(y.value.length)+"개 ",1)):p("",!0)]),n("div",Y,[n("div",{class:"attachment-container",onDragenter:_(E,["prevent"]),onDragleave:_(A,["prevent"]),onDragover:_(j,["prevent"]),onDrop:_(N,["prevent"])},[n("div",{class:G(["attachment-content",{"drag-over":v.value}])},[n("div",Z,[n("label",ee,[d(i,{name:"mdi:plus-circle-outline",size:"24"}),t[0]||(t[0]=n("span",null,"클릭하거나 드래그해서 파일을 추가하세요.",-1))]),n("input",{id:"file-upload",type:"file",class:"file-upload-input",multiple:"",accept:"image/*,video/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.hwp,.txt,.zip,.7z,.rar",onChange:$},null,32)]),c.modelValue.length===0?(s(),a("div",te,[n("div",ne,[d(i,{name:"mdi:file-outline",size:"24",class:"file-icon"}),t[1]||(t[1]=n("span",null,"파일 개수 : 0 / 5　　Total Size : 0 / 52,428,800 bytes",-1))]),t[2]||(t[2]=n("div",{class:"file-formats"},[n("span",null,"첨부 허용 확장자 : jpg,jpeg,gif,png,bmp,txt,pdf,xls,xlsx,ppt,pptx,doc,docx,hwp,zip,7z,rar,alz,hwpx,heic,avi,mp4")],-1))])):p("",!0),c.modelValue.length>0?(s(),a("div",ie,[n("div",le,[n("span",null,"파일 개수 : "+f(c.modelValue.length)+" / 5　　Total Size : "+f(U.value)+" / 52,428,800 bytes",1)]),F.value?(s(),a("div",ae,[n("div",se,[t[4]||(t[4]=n("h4",{class:"preview-title"},"📷 업로드한 이미지",-1)),c.modelValue.length>0?(s(),a("button",{key:0,onClick:O,class:"clear-all-btn"},[d(i,{name:"mdi:delete-sweep",size:"16"}),t[3]||(t[3]=P(" 전체 삭제 "))])):p("",!0)]),n("div",oe,[(s(!0),a(D,null,I(y.value,(l,r)=>(s(),a("div",{key:`preview-${r}`,class:"image-preview-item"},[n("img",{src:S(l.file),alt:l.file.name,class:"preview-image",onError:R,onLoad:C},null,40,re),n("div",ce,[n("button",{class:"image-delete-btn",onClick:x=>b(l.originalIndex)},[d(i,{name:"mdi:close",size:"18"})],8,de)])]))),128))])])):p("",!0),w.value.length>0?(s(),a("div",ue,[(s(!0),a(D,null,I(w.value,(l,r)=>(s(),a("div",{key:r,class:"uploaded-file-item mt-10"},[n("div",me,[d(i,{name:B(l.file),size:"20",class:"file-type-icon"},null,8,["name"]),n("span",pe,f(l.file.name),1),n("span",fe,"("+f(M(l.file.size))+")",1)]),n("button",{class:"file-delete-btn",onClick:x=>b(l.originalIndex)},[d(i,{name:"mdi:close",size:"16"})],8,ve)]))),128))])):p("",!0)])):p("",!0)],2)],32)])])])}}},ye=K(ge,[["__scopeId","data-v-b54ad5d3"]]);export{ye as default};
