import j from"./DVkhRjhE.js";import G from"./I0aCweQ4.js";import{r as p,z as x,G as E,c as o,o as a,a as i,k as s,t as h,b as g,C as L,J as c,w as v,x as w,d as b,n as J}from"./BLpWS0n0.js";import"./Clw50hdB.js";const M={class:"flex items-center gap-10"},q={class:"heading-4"},F={key:0,class:"grade-range-controls flex items-center gap-5 mr-5"},K={key:0,class:"table-actions"},P={class:"button-group flex items-center gap-5"},Q={key:1,class:"excel-controls flex items-center gap-5 mr-5"},W={key:0,class:"sort-mode-message"},X={key:1,class:"empty-state"},Y={class:"empty-content"},Z={class:"empty-title"},_={class:"empty-description"},ee={key:0,class:"empty-actions"},te={key:2,class:"table-scroll-container"},le={key:0},ae={key:1,class:"sticky-header"},oe={key:2},se={key:3},ne={key:0},de={key:1,class:"sticky-header"},ie={key:2},re={key:3},ue={key:4},ve={__name:"UiTable",props:{title:{type:String,default:""},bordered:{type:Boolean,default:!1},striped:{type:Boolean,default:!0},hover:{type:Boolean,default:!1},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},layout:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},isThLeft:{type:Boolean,default:!1},alignTop:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},maxHeight:{type:String,default:"400px"},fixHeader:{type:Boolean,default:!1},modelValue:{type:Array,default:()=>[]},editable:{type:Boolean,default:!1},excelControls:{type:Boolean,default:!1},excelDownloadLabel:{type:String,default:"엑셀 다운로드"},excelUploadLabel:{type:String,default:"엑셀 업로드"},defaultRowData:{type:Object,default:()=>({})},sortableOption:{type:Boolean,default:!1},canAddRow:{type:Boolean,default:!0},canSave:{type:Boolean,default:!0},canAddSortableButton:{type:Boolean,default:!0},gradeRangeControls:{type:Boolean,default:!1},emptyTitle:{type:String,default:"데이터가 없습니다"},emptyDescription:{type:String,default:"표시할 항목이 없습니다."},forceEmpty:{type:Boolean,default:!1}},emits:["update:modelValue","save","row-added","row-deleted","order-changed"],setup(e,{emit:O}){const m=O,r=e,n=p([]),u=p(r.sortableOption),k=p(!1),y=p(null),D=x(()=>r.forceEmpty||!r.modelValue||r.modelValue.length===0),S=x(()=>r.modelValue.length>0&&n.value.length===r.modelValue.length),B=()=>{S.value?n.value=[]:n.value=[...r.modelValue]},V=t=>{if(u.value)return;const l=n.value.findIndex(d=>d===t);l===-1?n.value.push(t):n.value.splice(l,1)},$=t=>n.value.includes(t),H=()=>({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...r.defaultRowData}),R=()=>{const t=H(),l=[...r.modelValue,t];m("update:modelValue",l),m("row-added",t)},U=()=>{if(n.value.length===0)return;const t=[...n.value],l=r.modelValue.filter(d=>!n.value.includes(d));m("update:modelValue",l),n.value=[],m("row-deleted",t)},I=()=>{u.value=!u.value,u.value||(n.value=[])},C=(t,l)=>{if(u.value){y.value=l,k.value=!0,t.dataTransfer.effectAllowed="move";try{const d=t.target.closest("tr");d&&t.dataTransfer.setDragImage(d,0,0)}catch(d){console.warn("Drag image not supported in this browser",d)}}},A=t=>{u.value&&(t.preventDefault(),t.dataTransfer.dropEffect="move")},T=(t,l)=>{if(!(!u.value||y.value===null)){if(t.preventDefault(),y.value!==l){const d=[...r.modelValue],f=d[y.value];d.splice(y.value,1),d.splice(l,0,f),m("update:modelValue",d),m("order-changed",{from:y.value,to:l,rows:d})}y.value=null,k.value=!1}},z=()=>{y.value=null,k.value=!1},N=()=>{m("save",r.modelValue),u.value=!1};return E(()=>r.modelValue,()=>{n.value=n.value.filter(t=>r.modelValue.some(l=>l===t))}),E(()=>r.editable,t=>{t||(u.value=!1)}),(t,l)=>{const d=j,f=G;return a(),o("div",{class:w(["ui-table-wrapper",[e.bordered&&"bordered",e.striped&&"striped",e.hover&&"hover",e.size,e.layout,e.scrollable&&"scrollable",k.value&&"dragging",e.editable&&"editable",e.alignTop&&"align-top"]]),style:J(e.scrollable?{maxHeight:e.maxHeight}:{})},[i("div",{class:w(["section-header flex items-center justify-between",e.fixHeader&&"sticky-header-btn"])},[i("div",M,[i("h2",q,h(e.title),1),e.gradeRangeControls?(a(),o("div",F,[i("div",null,[g(d,{label:"구간대 설정"})])])):s("",!0)]),e.editable?(a(),o("div",K,[i("div",P,[e.canAddRow?(a(),L(f,{key:0,type:"button",variant:"secondary-line","icon-only":"",onClick:R,title:"행 추가"},{default:v(()=>l[0]||(l[0]=[i("i",{class:"icon-md icon-plus icon-black"},null,-1)])),_:1})):s("",!0),g(f,{type:"button",variant:"secondary-line","icon-only":"",onClick:U,disabled:n.value.length===0,title:"선택한 행 삭제"},{default:v(()=>l[1]||(l[1]=[i("i",{class:"icon-md icon-delete"},null,-1)])),_:1},8,["disabled"]),e.canAddSortableButton?(a(),L(f,{key:1,type:"button",variant:"secondary-line","icon-only":"",onClick:I,class:w({active:u.value}),title:"정렬 모드"},{default:v(()=>l[2]||(l[2]=[i("i",{class:"icon-md icon-sort"},null,-1)])),_:1},8,["class"])):s("",!0),e.canSave?c(t.$slots,"action-button",{key:2},()=>[g(f,{type:"button",variant:"primary",onClick:N},{default:v(()=>l[3]||(l[3]=[b("저장")])),_:1})]):s("",!0)])])):s("",!0),e.excelControls?(a(),o("div",Q,[g(f,{variant:"secondary-line",size:"medium"},{default:v(()=>[l[4]||(l[4]=i("i",{class:"icon-md icon-excel"},null,-1)),b(" "+h(e.excelDownloadLabel),1)]),_:1}),g(f,{variant:"secondary-line",size:"medium"},{default:v(()=>[l[5]||(l[5]=i("i",{class:"icon-md icon-excel"},null,-1)),b(" "+h(e.excelUploadLabel),1)]),_:1})])):s("",!0)],2),u.value&&e.editable?(a(),o("div",W,l[6]||(l[6]=[b(" 행을 드래그하여 순서를 변경할 수 있습니다. "),i("br",null,null,-1),b("완료 후 정렬 버튼을 다시 클릭하세요. ")]))):s("",!0),D.value?(a(),o("div",X,[c(t.$slots,"empty",{addRow:R,editable:e.editable},()=>[i("div",Y,[i("h3",Z,h(e.emptyTitle),1),i("p",_,h(e.emptyDescription),1),e.editable&&e.canAddRow?(a(),o("div",ee,[g(f,{variant:"primary",onClick:R},{default:v(()=>l[7]||(l[7]=[i("i",{class:"icon-sm icon-plus"},null,-1),b(" 첫 번째 항목 추가 ")])),_:1})])):s("",!0)])])])):e.scrollable?(a(),o("div",te,[i("table",{class:w(["ui-table",{"th-left":e.isThLeft}])},[t.$slots.colgroup?(a(),o("colgroup",le,[c(t.$slots,"colgroup")])):s("",!0),t.$slots.header&&e.layout!=="horizontal"?(a(),o("thead",ae,[c(t.$slots,"header",{selectAll:B,isAllSelected:S.value,editable:e.editable})])):s("",!0),t.$slots.body?(a(),o("tbody",oe,[c(t.$slots,"body",{rows:e.modelValue,selectedRows:n.value,toggleRowSelection:V,isRowSelected:$,handleDragStart:C,handleDragOver:A,handleDrop:T,handleDragEnd:z,sortable:u.value,editable:e.editable})])):s("",!0),t.$slots.footer?(a(),o("tfoot",se,[c(t.$slots,"footer")])):s("",!0)],2)])):D.value?s("",!0):(a(),o("table",{key:3,class:w(["ui-table",{"th-left":e.isThLeft}])},[t.$slots.colgroup?(a(),o("colgroup",ne,[c(t.$slots,"colgroup")])):s("",!0),t.$slots.header&&e.layout!=="horizontal"?(a(),o("thead",de,[c(t.$slots,"header",{selectAll:B,isAllSelected:S.value,editable:e.editable})])):s("",!0),e.layout==="horizontal"?(a(),o("thead",ie,[c(t.$slots,"header")])):s("",!0),t.$slots.body?(a(),o("tbody",re,[c(t.$slots,"body",{rows:e.modelValue,selectedRows:n.value,toggleRowSelection:V,isRowSelected:$,handleDragStart:C,handleDragOver:A,handleDrop:T,handleDragEnd:z,sortable:u.value,editable:e.editable})])):s("",!0),t.$slots.footer?(a(),o("tfoot",ue,[c(t.$slots,"footer")])):s("",!0)],2))],6)}}};export{ve as default};
