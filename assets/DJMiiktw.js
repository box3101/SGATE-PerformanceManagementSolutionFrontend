import E from"./5dSZYmZ5.js";import I from"./BZu1_yGw.js";import{r as h,B as N,Z as k,c as r,o as i,a as d,k as u,t as p,b as v,C as H,D as y,w as g,x as w,d as R,n as j}from"./Dojx9gEz.js";import"./w4DddYWl.js";const Z={class:"section-header flex items-center justify-between"},q={class:"flex items-center gap-10"},F={class:"heading-4"},G={key:0,class:"grade-range-controls flex items-center gap-5 mr-5"},J={key:0,class:"table-actions"},K={class:"button-group flex items-center gap-5"},M={key:1,class:"excel-controls flex items-center gap-5 mr-5"},P={key:0,class:"sort-mode-message"},Q={key:0},W={key:2},X={key:3},te={__name:"UiTable",props:{bordered:{type:Boolean,default:!1},striped:{type:Boolean,default:!1},hover:{type:Boolean,default:!1},size:{type:String,default:"medium",validator:l=>["small","medium","large"].includes(l)},layout:{type:String,default:"vertical",validator:l=>["vertical","horizontal"].includes(l)},isThLeft:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},maxHeight:{type:String,default:"400px"},modelValue:{type:Array,default:()=>[]},editable:{type:Boolean,default:!1},excelControls:{type:Boolean,default:!1},excelDownloadLabel:{type:String,default:"엑셀 다운로드"},excelUploadLabel:{type:String,default:"엑셀 업로드"},defaultRowData:{type:Object,default:()=>({})},sortableOption:{type:Boolean,default:!1},title:{type:String,default:""},canAddRow:{type:Boolean,default:!0},gradeRangeControls:{type:Boolean,default:!1}},emits:["update:modelValue","save","row-added","row-deleted","order-changed"],setup(l,{emit:S}){const m=S,s=l,o=h([]),n=h(s.sortableOption),b=h(!1),c=h(null),D=N(()=>s.modelValue.length>0&&o.value.length===s.modelValue.length),V=()=>{D.value?o.value=[]:o.value=[...s.modelValue]},x=e=>{if(n.value)return;const t=o.value.findIndex(a=>a===e);t===-1?o.value.push(e):o.value.splice(t,1)},B=e=>o.value.includes(e),C=()=>{const t={id:Date.now(),gradeCount:0,...s.defaultRowData},a=[...s.modelValue,t];m("update:modelValue",a),m("row-added",t)},$=()=>{if(o.value.length===0)return;const e=[...o.value],t=s.modelValue.filter(a=>!o.value.includes(a));m("update:modelValue",t),o.value=[],m("row-deleted",e)},z=()=>{n.value=!n.value,n.value||(o.value=[])},A=(e,t)=>{if(n.value){c.value=t,b.value=!0,e.dataTransfer.effectAllowed="move";try{const a=e.target.closest("tr");a&&e.dataTransfer.setDragImage(a,0,0)}catch(a){console.warn("Drag image not supported in this browser",a)}}},T=e=>{n.value&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},L=(e,t)=>{if(!(!n.value||c.value===null)){if(e.preventDefault(),c.value!==t){const a=[...s.modelValue],f=a[c.value];a.splice(c.value,1),a.splice(t,0,f),m("update:modelValue",a),m("order-changed",{from:c.value,to:t,rows:a})}c.value=null,b.value=!1}},O=()=>{c.value=null,b.value=!1},U=()=>{m("save",s.modelValue),n.value=!1};return k(()=>s.modelValue,()=>{o.value=o.value.filter(e=>s.modelValue.some(t=>t===e))}),k(()=>s.editable,e=>{e||(n.value=!1)}),(e,t)=>{const a=E,f=I;return i(),r("div",{class:w(["ui-table-wrapper",[l.bordered&&"bordered",l.striped&&"striped",l.hover&&"hover",l.size,l.layout,l.scrollable&&"scrollable",b.value&&"dragging",l.editable&&"editable"]]),style:j(l.scrollable?{maxHeight:l.maxHeight}:{})},[d("div",Z,[d("div",q,[d("h2",F,p(l.title),1),l.gradeRangeControls?(i(),r("div",G,[d("div",null,[v(a,{label:"구간대 설정"})])])):u("",!0)]),l.editable?(i(),r("div",J,[d("div",K,[l.canAddRow?(i(),H(f,{key:0,type:"button",variant:"secondary-line","icon-only":"",onClick:C,title:"행 추가"},{default:g(()=>t[0]||(t[0]=[d("i",{class:"icon-md icon-plus"},null,-1)])),_:1})):u("",!0),v(f,{type:"button",variant:"secondary-line","icon-only":"",onClick:$,disabled:o.value.length===0,title:"선택한 행 삭제"},{default:g(()=>t[1]||(t[1]=[d("i",{class:"icon-md icon-delete"},null,-1)])),_:1},8,["disabled"]),v(f,{type:"button",variant:"secondary-line","icon-only":"",onClick:z,class:w({active:n.value}),title:"정렬 모드"},{default:g(()=>t[2]||(t[2]=[d("i",{class:"icon-md icon-sort"},null,-1)])),_:1},8,["class"]),y(e.$slots,"action-button",{},()=>[v(f,{type:"button",variant:"primary",onClick:U},{default:g(()=>t[3]||(t[3]=[R("저장")])),_:1})])])])):u("",!0),l.excelControls?(i(),r("div",M,[v(f,{variant:"secondary-line",size:"medium"},{default:g(()=>[t[4]||(t[4]=d("i",{class:"icon-md icon-excel"},null,-1)),R(" "+p(l.excelDownloadLabel),1)]),_:1}),v(f,{variant:"secondary-line",size:"medium"},{default:g(()=>[t[5]||(t[5]=d("i",{class:"icon-md icon-excel"},null,-1)),R(" "+p(l.excelUploadLabel),1)]),_:1})])):u("",!0)]),n.value&&l.editable?(i(),r("div",P," 행을 드래그하여 순서를 변경할 수 있습니다. 완료 후 정렬 버튼을 다시 클릭하세요. ")):u("",!0),d("table",{class:w(["ui-table",{"th-left":l.isThLeft}])},[e.$slots.colgroup?(i(),r("colgroup",Q,[y(e.$slots,"colgroup")])):u("",!0),e.$slots.header&&l.layout!=="horizontal"?(i(),r("thead",{key:1,class:w({"sticky-header":l.scrollable})},[y(e.$slots,"header",{selectAll:V,isAllSelected:D.value,editable:l.editable})],2)):u("",!0),e.$slots.body?(i(),r("tbody",W,[y(e.$slots,"body",{rows:l.modelValue,selectedRows:o.value,toggleRowSelection:x,isRowSelected:B,handleDragStart:A,handleDragOver:T,handleDrop:L,handleDragEnd:O,sortable:n.value,editable:l.editable})])):u("",!0),e.$slots.footer?(i(),r("tfoot",X,[y(e.$slots,"footer")])):u("",!0)],2)],6)}}};export{te as default};
