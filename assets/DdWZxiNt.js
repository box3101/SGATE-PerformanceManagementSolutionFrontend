import H from"./wUND9Ilg.js";import U from"./Bf1lr258.js";import{r as k,E as I,a0 as z,c as d,o as s,a as u,k as n,t as R,b as m,z as N,G as c,w as y,x as b,d as h,n as j}from"./Basf_yKX.js";import"./DtGG2PlH.js";const G={class:"flex items-center gap-10"},q={class:"heading-4"},F={key:0,class:"grade-range-controls flex items-center gap-5 mr-5"},J={key:0,class:"table-actions"},K={class:"button-group flex items-center gap-5"},M={key:1,class:"excel-controls flex items-center gap-5 mr-5"},P={key:0,class:"sort-mode-message"},Q={key:1,class:"table-scroll-container"},W={key:0},X={key:1,class:"sticky-header"},Y={key:2},Z={key:3},_={key:0},ee={key:1,class:"sticky-header"},le={key:2},te={key:3},ae={key:4},ie={__name:"UiTable",props:{bordered:{type:Boolean,default:!1},striped:{type:Boolean,default:!0},hover:{type:Boolean,default:!1},size:{type:String,default:"medium",validator:l=>["small","medium","large"].includes(l)},layout:{type:String,default:"vertical",validator:l=>["vertical","horizontal"].includes(l)},isThLeft:{type:Boolean,default:!1},alignTop:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},maxHeight:{type:String,default:"400px"},fixHeader:{type:Boolean,default:!1},modelValue:{type:Array,default:()=>[]},editable:{type:Boolean,default:!1},excelControls:{type:Boolean,default:!1},excelDownloadLabel:{type:String,default:"엑셀 다운로드"},excelUploadLabel:{type:String,default:"엑셀 업로드"},defaultRowData:{type:Object,default:()=>({})},sortableOption:{type:Boolean,default:!1},title:{type:String,default:""},canAddRow:{type:Boolean,default:!0},canSave:{type:Boolean,default:!0},gradeRangeControls:{type:Boolean,default:!1}},emits:["update:modelValue","save","row-added","row-deleted","order-changed"],setup(l,{emit:A}){const g=A,r=l,o=k([]),i=k(r.sortableOption),w=k(!1),f=k(null),S=I(()=>r.modelValue.length>0&&o.value.length===r.modelValue.length),p=()=>{S.value?o.value=[]:o.value=[...r.modelValue]},D=e=>{if(i.value)return;const t=o.value.findIndex(a=>a===e);t===-1?o.value.push(e):o.value.splice(t,1)},V=e=>o.value.includes(e),T=()=>{const t={id:Date.now(),gradeCount:0,...r.defaultRowData},a=[...r.modelValue,t];g("update:modelValue",a),g("row-added",t)},L=()=>{if(o.value.length===0)return;const e=[...o.value],t=r.modelValue.filter(a=>!o.value.includes(a));g("update:modelValue",t),o.value=[],g("row-deleted",e)},E=()=>{i.value=!i.value,i.value||(o.value=[])},B=(e,t)=>{if(i.value){f.value=t,w.value=!0,e.dataTransfer.effectAllowed="move";try{const a=e.target.closest("tr");a&&e.dataTransfer.setDragImage(a,0,0)}catch(a){console.warn("Drag image not supported in this browser",a)}}},$=e=>{i.value&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},C=(e,t)=>{if(!(!i.value||f.value===null)){if(e.preventDefault(),f.value!==t){const a=[...r.modelValue],v=a[f.value];a.splice(f.value,1),a.splice(t,0,v),g("update:modelValue",a),g("order-changed",{from:f.value,to:t,rows:a})}f.value=null,w.value=!1}},x=()=>{f.value=null,w.value=!1},O=()=>{g("save",r.modelValue),i.value=!1};return z(()=>r.modelValue,()=>{o.value=o.value.filter(e=>r.modelValue.some(t=>t===e))}),z(()=>r.editable,e=>{e||(i.value=!1)}),(e,t)=>{const a=H,v=U;return s(),d("div",{class:b(["ui-table-wrapper",[l.bordered&&"bordered",l.striped&&"striped",l.hover&&"hover",l.size,l.layout,l.scrollable&&"scrollable",w.value&&"dragging",l.editable&&"editable",l.alignTop&&"align-top"]]),style:j(l.scrollable?{maxHeight:l.maxHeight}:{})},[u("div",{class:b(["section-header flex items-center justify-between",l.fixHeader&&"sticky-header-btn"])},[u("div",G,[u("h2",q,R(l.title),1),l.gradeRangeControls?(s(),d("div",F,[u("div",null,[m(a,{label:"구간대 설정"})])])):n("",!0)]),l.editable?(s(),d("div",J,[u("div",K,[l.canAddRow?(s(),N(v,{key:0,type:"button",variant:"secondary-line","icon-only":"",onClick:T,title:"행 추가"},{default:y(()=>t[0]||(t[0]=[u("i",{class:"icon-md icon-plus"},null,-1)])),_:1})):n("",!0),m(v,{type:"button",variant:"secondary-line","icon-only":"",onClick:L,disabled:o.value.length===0,title:"선택한 행 삭제"},{default:y(()=>t[1]||(t[1]=[u("i",{class:"icon-md icon-delete"},null,-1)])),_:1},8,["disabled"]),m(v,{type:"button",variant:"secondary-line","icon-only":"",onClick:E,class:b({active:i.value}),title:"정렬 모드"},{default:y(()=>t[2]||(t[2]=[u("i",{class:"icon-md icon-sort"},null,-1)])),_:1},8,["class"]),l.canSave?c(e.$slots,"action-button",{key:1},()=>[m(v,{type:"button",variant:"primary",onClick:O},{default:y(()=>t[3]||(t[3]=[h("저장")])),_:1})]):n("",!0)])])):n("",!0),l.excelControls?(s(),d("div",M,[m(v,{variant:"secondary-line",size:"medium"},{default:y(()=>[t[4]||(t[4]=u("i",{class:"icon-md icon-excel"},null,-1)),h(" "+R(l.excelDownloadLabel),1)]),_:1}),m(v,{variant:"secondary-line",size:"medium"},{default:y(()=>[t[5]||(t[5]=u("i",{class:"icon-md icon-excel"},null,-1)),h(" "+R(l.excelUploadLabel),1)]),_:1})])):n("",!0)],2),i.value&&l.editable?(s(),d("div",P,t[6]||(t[6]=[h(" 행을 드래그하여 순서를 변경할 수 있습니다. "),u("br",null,null,-1),h("완료 후 정렬 버튼을 다시 클릭하세요. ")]))):n("",!0),l.scrollable?(s(),d("div",Q,[u("table",{class:b(["ui-table",{"th-left":l.isThLeft}])},[e.$slots.colgroup?(s(),d("colgroup",W,[c(e.$slots,"colgroup")])):n("",!0),e.$slots.header&&l.layout!=="horizontal"?(s(),d("thead",X,[c(e.$slots,"header",{selectAll:p,isAllSelected:S.value,editable:l.editable})])):n("",!0),e.$slots.body?(s(),d("tbody",Y,[c(e.$slots,"body",{rows:l.modelValue,selectedRows:o.value,toggleRowSelection:D,isRowSelected:V,handleDragStart:B,handleDragOver:$,handleDrop:C,handleDragEnd:x,sortable:i.value,editable:l.editable})])):n("",!0),e.$slots.footer?(s(),d("tfoot",Z,[c(e.$slots,"footer")])):n("",!0)],2)])):(s(),d("table",{key:2,class:b(["ui-table",{"th-left":l.isThLeft}])},[e.$slots.colgroup?(s(),d("colgroup",_,[c(e.$slots,"colgroup")])):n("",!0),e.$slots.header&&l.layout!=="horizontal"?(s(),d("thead",ee,[c(e.$slots,"header",{selectAll:p,isAllSelected:S.value,editable:l.editable})])):n("",!0),l.layout==="horizontal"?(s(),d("thead",le,[c(e.$slots,"header")])):n("",!0),e.$slots.body?(s(),d("tbody",te,[c(e.$slots,"body",{rows:l.modelValue,selectedRows:o.value,toggleRowSelection:D,isRowSelected:V,handleDragStart:B,handleDragOver:$,handleDrop:C,handleDragEnd:x,sortable:i.value,editable:l.editable})])):n("",!0),e.$slots.footer?(s(),d("tfoot",ae,[c(e.$slots,"footer")])):n("",!0)],2))],6)}}};export{ie as default};
