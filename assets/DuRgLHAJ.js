import U from"./Clfyepop.js";import E from"./FFuudKe5.js";import{r as p,B as I,Z as S,c as r,o as i,a as d,k as u,t as k,b as m,C as N,D as y,w as g,x as b,d as h,n as j}from"./BQVbUQtV.js";import"./mIdRHJos.js";const Z={class:"flex items-center gap-10"},q={class:"heading-4"},F={key:0,class:"grade-range-controls flex items-center gap-5 mr-5"},G={key:0,class:"table-actions"},J={class:"button-group flex items-center gap-5"},K={key:1,class:"excel-controls flex items-center gap-5 mr-5"},M={key:0,class:"sort-mode-message"},P={key:0},Q={key:2},W={key:3},le={__name:"UiTable",props:{bordered:{type:Boolean,default:!1},striped:{type:Boolean,default:!0},hover:{type:Boolean,default:!1},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},layout:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},isThLeft:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},maxHeight:{type:String,default:"400px"},fixHeader:{type:Boolean,default:!1},modelValue:{type:Array,default:()=>[]},editable:{type:Boolean,default:!1},excelControls:{type:Boolean,default:!1},excelDownloadLabel:{type:String,default:"엑셀 다운로드"},excelUploadLabel:{type:String,default:"엑셀 업로드"},defaultRowData:{type:Object,default:()=>({})},sortableOption:{type:Boolean,default:!1},title:{type:String,default:""},canAddRow:{type:Boolean,default:!0},canSave:{type:Boolean,default:!0},gradeRangeControls:{type:Boolean,default:!1}},emits:["update:modelValue","save","row-added","row-deleted","order-changed"],setup(e,{emit:x}){const v=x,n=e,o=p([]),s=p(n.sortableOption),w=p(!1),c=p(null),R=I(()=>n.modelValue.length>0&&o.value.length===n.modelValue.length),D=()=>{R.value?o.value=[]:o.value=[...n.modelValue]},V=l=>{if(s.value)return;const t=o.value.findIndex(a=>a===l);t===-1?o.value.push(l):o.value.splice(t,1)},B=l=>o.value.includes(l),C=()=>{const t={id:Date.now(),gradeCount:0,...n.defaultRowData},a=[...n.modelValue,t];v("update:modelValue",a),v("row-added",t)},$=()=>{if(o.value.length===0)return;const l=[...o.value],t=n.modelValue.filter(a=>!o.value.includes(a));v("update:modelValue",t),o.value=[],v("row-deleted",l)},z=()=>{s.value=!s.value,s.value||(o.value=[])},A=(l,t)=>{if(s.value){c.value=t,w.value=!0,l.dataTransfer.effectAllowed="move";try{const a=l.target.closest("tr");a&&l.dataTransfer.setDragImage(a,0,0)}catch(a){console.warn("Drag image not supported in this browser",a)}}},T=l=>{s.value&&(l.preventDefault(),l.dataTransfer.dropEffect="move")},L=(l,t)=>{if(!(!s.value||c.value===null)){if(l.preventDefault(),c.value!==t){const a=[...n.modelValue],f=a[c.value];a.splice(c.value,1),a.splice(t,0,f),v("update:modelValue",a),v("order-changed",{from:c.value,to:t,rows:a})}c.value=null,w.value=!1}},H=()=>{c.value=null,w.value=!1},O=()=>{v("save",n.modelValue),s.value=!1};return S(()=>n.modelValue,()=>{o.value=o.value.filter(l=>n.modelValue.some(t=>t===l))}),S(()=>n.editable,l=>{l||(s.value=!1)}),(l,t)=>{const a=U,f=E;return i(),r("div",{class:b(["ui-table-wrapper",[e.bordered&&"bordered",e.striped&&"striped",e.hover&&"hover",e.size,e.layout,e.scrollable&&"scrollable",w.value&&"dragging",e.editable&&"editable"]]),style:j(e.scrollable?{maxHeight:e.maxHeight}:{})},[d("div",{class:b(["section-header flex items-center justify-between",e.fixHeader&&"sticky-header-btn"])},[d("div",Z,[d("h2",q,k(e.title),1),e.gradeRangeControls?(i(),r("div",F,[d("div",null,[m(a,{label:"구간대 설정"})])])):u("",!0)]),e.editable?(i(),r("div",G,[d("div",J,[e.canAddRow?(i(),N(f,{key:0,type:"button",variant:"secondary-line","icon-only":"",onClick:C,title:"행 추가"},{default:g(()=>t[0]||(t[0]=[d("i",{class:"icon-md icon-plus"},null,-1)])),_:1})):u("",!0),m(f,{type:"button",variant:"secondary-line","icon-only":"",onClick:$,disabled:o.value.length===0,title:"선택한 행 삭제"},{default:g(()=>t[1]||(t[1]=[d("i",{class:"icon-md icon-delete"},null,-1)])),_:1},8,["disabled"]),m(f,{type:"button",variant:"secondary-line","icon-only":"",onClick:z,class:b({active:s.value}),title:"정렬 모드"},{default:g(()=>t[2]||(t[2]=[d("i",{class:"icon-md icon-sort"},null,-1)])),_:1},8,["class"]),e.canSave?y(l.$slots,"action-button",{key:1},()=>[m(f,{type:"button",variant:"primary",onClick:O},{default:g(()=>t[3]||(t[3]=[h("저장")])),_:1})]):u("",!0)])])):u("",!0),e.excelControls?(i(),r("div",K,[m(f,{variant:"secondary-line",size:"medium"},{default:g(()=>[t[4]||(t[4]=d("i",{class:"icon-md icon-excel"},null,-1)),h(" "+k(e.excelDownloadLabel),1)]),_:1}),m(f,{variant:"secondary-line",size:"medium"},{default:g(()=>[t[5]||(t[5]=d("i",{class:"icon-md icon-excel"},null,-1)),h(" "+k(e.excelUploadLabel),1)]),_:1})])):u("",!0)],2),s.value&&e.editable?(i(),r("div",M,t[6]||(t[6]=[h(" 행을 드래그하여 순서를 변경할 수 있습니다. "),d("br",null,null,-1),h("완료 후 정렬 버튼을 다시 클릭하세요. ")]))):u("",!0),d("table",{class:b(["ui-table",{"th-left":e.isThLeft}])},[l.$slots.colgroup?(i(),r("colgroup",P,[y(l.$slots,"colgroup")])):u("",!0),l.$slots.header&&e.layout!=="horizontal"?(i(),r("thead",{key:1,class:b({"sticky-header":e.scrollable,"sticky-header-no":!e.editable})},[y(l.$slots,"header",{selectAll:D,isAllSelected:R.value,editable:e.editable})],2)):u("",!0),l.$slots.body?(i(),r("tbody",Q,[y(l.$slots,"body",{rows:e.modelValue,selectedRows:o.value,toggleRowSelection:V,isRowSelected:B,handleDragStart:A,handleDragOver:T,handleDrop:L,handleDragEnd:H,sortable:s.value,editable:e.editable})])):u("",!0),l.$slots.footer?(i(),r("tfoot",W,[y(l.$slots,"footer")])):u("",!0)],2)],6)}}};export{le as default};
