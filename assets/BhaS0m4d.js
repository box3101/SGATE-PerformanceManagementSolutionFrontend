import U from"./CSuVhUU7.js";import I from"./D0OnSFOR.js";import{r as k,z as N,G as z,c as n,o,a as u,k as d,t as R,b as m,C as j,J as c,w as y,x as b,d as h,n as G}from"./CIE_3AOX.js";import"./CN1l-3pm.js";const J={class:"flex items-center gap-10"},M={class:"heading-4"},q={key:0,class:"grade-range-controls flex items-center gap-5 mr-5"},F={key:0,class:"table-actions"},K={class:"button-group flex items-center gap-5"},P={key:1,class:"excel-controls flex items-center gap-5 mr-5"},Q={key:0,class:"sort-mode-message"},W={key:1,class:"table-scroll-container"},X={key:0},Y={key:1,class:"sticky-header"},Z={key:2},_={key:3},ee={key:0},le={key:1,class:"sticky-header"},te={key:2},ae={key:3},oe={key:4},re={__name:"UiTable",props:{title:{type:String,default:""},bordered:{type:Boolean,default:!1},striped:{type:Boolean,default:!0},hover:{type:Boolean,default:!1},size:{type:String,default:"medium",validator:l=>["small","medium","large"].includes(l)},layout:{type:String,default:"vertical",validator:l=>["vertical","horizontal"].includes(l)},isThLeft:{type:Boolean,default:!1},alignTop:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},maxHeight:{type:String,default:"400px"},fixHeader:{type:Boolean,default:!1},modelValue:{type:Array,default:()=>[]},editable:{type:Boolean,default:!1},excelControls:{type:Boolean,default:!1},excelDownloadLabel:{type:String,default:"엑셀 다운로드"},excelUploadLabel:{type:String,default:"엑셀 업로드"},defaultRowData:{type:Object,default:()=>({})},sortableOption:{type:Boolean,default:!1},title:{type:String,default:""},canAddRow:{type:Boolean,default:!0},canSave:{type:Boolean,default:!0},gradeRangeControls:{type:Boolean,default:!1}},emits:["update:modelValue","save","row-added","row-deleted","order-changed"],setup(l,{emit:A}){const g=A,r=l,a=k([]),i=k(r.sortableOption),w=k(!1),f=k(null),S=N(()=>r.modelValue.length>0&&a.value.length===r.modelValue.length),p=()=>{S.value?a.value=[]:a.value=[...r.modelValue]},D=e=>{if(i.value)return;const t=a.value.findIndex(s=>s===e);t===-1?a.value.push(e):a.value.splice(t,1)},V=e=>a.value.includes(e),T=()=>({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...r.defaultRowData}),L=()=>{const e=T(),t=[...r.modelValue,e];g("update:modelValue",t),g("row-added",e)},O=()=>{if(a.value.length===0)return;const e=[...a.value],t=r.modelValue.filter(s=>!a.value.includes(s));g("update:modelValue",t),a.value=[],g("row-deleted",e)},E=()=>{i.value=!i.value,i.value||(a.value=[])},$=(e,t)=>{if(i.value){f.value=t,w.value=!0,e.dataTransfer.effectAllowed="move";try{const s=e.target.closest("tr");s&&e.dataTransfer.setDragImage(s,0,0)}catch(s){console.warn("Drag image not supported in this browser",s)}}},B=e=>{i.value&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},C=(e,t)=>{if(!(!i.value||f.value===null)){if(e.preventDefault(),f.value!==t){const s=[...r.modelValue],v=s[f.value];s.splice(f.value,1),s.splice(t,0,v),g("update:modelValue",s),g("order-changed",{from:f.value,to:t,rows:s})}f.value=null,w.value=!1}},x=()=>{f.value=null,w.value=!1},H=()=>{g("save",r.modelValue),i.value=!1};return z(()=>r.modelValue,()=>{a.value=a.value.filter(e=>r.modelValue.some(t=>t===e))}),z(()=>r.editable,e=>{e||(i.value=!1)}),(e,t)=>{const s=U,v=I;return o(),n("div",{class:b(["ui-table-wrapper",[l.bordered&&"bordered",l.striped&&"striped",l.hover&&"hover",l.size,l.layout,l.scrollable&&"scrollable",w.value&&"dragging",l.editable&&"editable",l.alignTop&&"align-top"]]),style:G(l.scrollable?{maxHeight:l.maxHeight}:{})},[u("div",{class:b(["section-header flex items-center justify-between",l.fixHeader&&"sticky-header-btn"])},[u("div",J,[u("h2",M,R(l.title),1),l.gradeRangeControls?(o(),n("div",q,[u("div",null,[m(s,{label:"구간대 설정"})])])):d("",!0)]),l.editable?(o(),n("div",F,[u("div",K,[l.canAddRow?(o(),j(v,{key:0,type:"button",variant:"secondary-line","icon-only":"",onClick:L,title:"행 추가"},{default:y(()=>t[0]||(t[0]=[u("i",{class:"icon-md icon-plus icon-black"},null,-1)])),_:1})):d("",!0),m(v,{type:"button",variant:"secondary-line","icon-only":"",onClick:O,disabled:a.value.length===0,title:"선택한 행 삭제"},{default:y(()=>t[1]||(t[1]=[u("i",{class:"icon-md icon-delete"},null,-1)])),_:1},8,["disabled"]),m(v,{type:"button",variant:"secondary-line","icon-only":"",onClick:E,class:b({active:i.value}),title:"정렬 모드"},{default:y(()=>t[2]||(t[2]=[u("i",{class:"icon-md icon-sort"},null,-1)])),_:1},8,["class"]),l.canSave?c(e.$slots,"action-button",{key:1},()=>[m(v,{type:"button",variant:"primary",onClick:H},{default:y(()=>t[3]||(t[3]=[h("저장")])),_:1})]):d("",!0)])])):d("",!0),l.excelControls?(o(),n("div",P,[m(v,{variant:"secondary-line",size:"medium"},{default:y(()=>[t[4]||(t[4]=u("i",{class:"icon-md icon-excel"},null,-1)),h(" "+R(l.excelDownloadLabel),1)]),_:1}),m(v,{variant:"secondary-line",size:"medium"},{default:y(()=>[t[5]||(t[5]=u("i",{class:"icon-md icon-excel"},null,-1)),h(" "+R(l.excelUploadLabel),1)]),_:1})])):d("",!0)],2),i.value&&l.editable?(o(),n("div",Q,t[6]||(t[6]=[h(" 행을 드래그하여 순서를 변경할 수 있습니다. "),u("br",null,null,-1),h("완료 후 정렬 버튼을 다시 클릭하세요. ")]))):d("",!0),l.scrollable?(o(),n("div",W,[u("table",{class:b(["ui-table",{"th-left":l.isThLeft}])},[e.$slots.colgroup?(o(),n("colgroup",X,[c(e.$slots,"colgroup")])):d("",!0),e.$slots.header&&l.layout!=="horizontal"?(o(),n("thead",Y,[c(e.$slots,"header",{selectAll:p,isAllSelected:S.value,editable:l.editable})])):d("",!0),e.$slots.body?(o(),n("tbody",Z,[c(e.$slots,"body",{rows:l.modelValue,selectedRows:a.value,toggleRowSelection:D,isRowSelected:V,handleDragStart:$,handleDragOver:B,handleDrop:C,handleDragEnd:x,sortable:i.value,editable:l.editable})])):d("",!0),e.$slots.footer?(o(),n("tfoot",_,[c(e.$slots,"footer")])):d("",!0)],2)])):(o(),n("table",{key:2,class:b(["ui-table",{"th-left":l.isThLeft}])},[e.$slots.colgroup?(o(),n("colgroup",ee,[c(e.$slots,"colgroup")])):d("",!0),e.$slots.header&&l.layout!=="horizontal"?(o(),n("thead",le,[c(e.$slots,"header",{selectAll:p,isAllSelected:S.value,editable:l.editable})])):d("",!0),l.layout==="horizontal"?(o(),n("thead",te,[c(e.$slots,"header")])):d("",!0),e.$slots.body?(o(),n("tbody",ae,[c(e.$slots,"body",{rows:l.modelValue,selectedRows:a.value,toggleRowSelection:D,isRowSelected:V,handleDragStart:$,handleDragOver:B,handleDrop:C,handleDragEnd:x,sortable:i.value,editable:l.editable})])):d("",!0),e.$slots.footer?(o(),n("tfoot",oe,[c(e.$slots,"footer")])):d("",!0)],2))],6)}}};export{re as default};
