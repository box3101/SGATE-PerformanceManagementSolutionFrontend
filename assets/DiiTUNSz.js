import j from"./C-7lUVPa.js";import A from"./ByTEoRm7.js";import F from"./c0WrynZ_.js";import{_ as P,r as L,z as I,a2 as M,c as p,b as h,w as f,o as c,F as q,g as J,x as R,k as m,a,m as k,d as _,t as v}from"./DdEsZLHH.js";import"./BXnp1M__.js";const K={class:"flex items-center gap-2"},Q=["draggable","onDragstart","onDrop"],W=["rowspan"],X=["rowspan"],Y={key:0,class:"definition-content"},Z={key:1,class:"category-content"},ee=["rowspan"],te={class:"pd-trl10 br vertical-top behavior-cell"},oe={class:"text-center"},re={class:"text-center"},se=["rowspan"],ae={__name:"CompetencyInfoPanel",setup(ne){const i=L([{id:"group_1",type:"group",isRowspanGroup:!0,competencyName:"전문가의식",definition:"회사의 목표에 따라 부하의 능력을 최대한으로 발휘 시키려고 노력하며, 평소에 부하의 능력, 적성을 정확히 파악하여 그에 따라 일을 맡기고 지속적으로 육성하는가.",category:"BARS",behaviors:[{behavior:"업무 수행에 있어 높은 수준의 원칙과 완성도를 보이며, 체계적이고 독자적인 자기개발에 매진함은 물론, 동료들 또한 적극적으로 업무에 임하도록 기준을 만들고 격려, 유도한다.",level:"5/100",weight:"-"},{behavior:"업무 수행 시 원칙과 기준을 세우고 이에 따라 완성도 높은 결과를 도출하며, 자기개발을 위해 노력하고 동료들과의 협력을 이끌어낸다.",level:"4/80",weight:"-"},{behavior:"업무 수행 시 일정한 원칙과 기준을 가지고 있으며, 지속적인 자기개발을 위해 노력하고 동료들과 원활한 관계를 유지한다.",level:"3/60",weight:"-"}],sortOrder:1},{id:"single_1",type:"single",isRowspanGroup:!1,category:"핵심역량",categoryType:"리더십",behavior:"팀을 이끌고 목표를 달성하는 능력",level:"5",weight:"30",sortOrder:2},{id:"single_2",type:"single",isRowspanGroup:!1,category:"직무역량",categoryType:"문제해결",behavior:"복잡한 문제를 분석하고 해결하는 능력",level:"4",weight:"25",sortOrder:3},{id:"group_2",type:"group",isRowspanGroup:!0,competencyName:"협업능력",definition:"다양한 배경을 가진 구성원들과 효과적으로 협력하여 공동의 목표를 달성하는 능력",category:"BEI",behaviors:[{behavior:"팀원들과의 협력을 통해 시너지를 창출하고, 갈등 상황에서도 건설적인 해결책을 모색한다.",level:"5/100",weight:"25"},{behavior:"팀원들과 협력하여 업무를 수행하며, 의견 차이가 있을 때 적절한 조율을 시도한다.",level:"3/60",weight:"15"}],sortOrder:4},{id:"single_3",type:"single",isRowspanGroup:!1,category:"직무역량",categoryType:"전문성",behavior:"업무 분야의 전문 지식과 기술을 보유하고 활용",level:"4",weight:"22",sortOrder:5}]),G=I(()=>{const t=[];return[...i.value].sort((o,s)=>o.sortOrder-s.sortOrder).forEach(o=>{o.type==="group"?o.behaviors.forEach((s,d)=>{t.push({id:`${o.id}_${d}`,groupId:o.id,subIndex:d,isRowspanGroup:!0,isGroupHeader:d===0,competencyName:o.competencyName,definition:o.definition,type:o.category,behavior:s.behavior,level:s.level,weight:s.weight,rowspanCount:d===0?o.behaviors.length:0,totalGroupSize:o.behaviors.length,sortOrder:o.sortOrder})}):t.push({id:o.id,isRowspanGroup:!1,category:o.category,type:o.categoryType,behavior:o.behavior,level:o.level,weight:o.weight,sortOrder:o.sortOrder})}),t}),C=I(()=>!i.value.some(t=>t.type==="group")),D=(t,e)=>{if(!t.isRowspanGroup)return!0;switch(e){case"checkbox":case"definition":case"type":case"actions":return t.isGroupHeader;default:return!0}},x=(t,e)=>{if(!t.isRowspanGroup||!t.isGroupHeader)return 1;switch(e){case"checkbox":case"definition":case"type":case"actions":return t.totalGroupSize;default:return 1}},N=t=>{const e=[];return t.isRowspanGroup&&(e.push("rowspan-group"),t.isGroupHeader&&e.push("group-header")),e.join(" ")},V=t=>t.isRowspanGroup?t.isGroupHeader:!0,T=t=>{if(i.value.some(s=>s.type==="group"))return console.warn("그룹 행이 있는 경우 일반 정렬을 사용할 수 없습니다. 드래그 앤 드롭을 사용하세요."),!1;const{field:e,direction:o}=t;i.value.sort((s,d)=>{let l=s[e]||"",u=d[e]||"";return!isNaN(l)&&!isNaN(u)&&(l=Number(l),u=Number(u)),o==="asc"?l>u?1:-1:l<u?1:-1}),i.value.forEach((s,d)=>{s.sortOrder=d+1})},S=(t,e,o)=>{if(o.isRowspanGroup&&!o.isGroupHeader)return t.preventDefault(),!1;t.dataTransfer.setData("sourceIndex",e.toString()),t.dataTransfer.setData("sourceId",o.groupId||o.id),t.dataTransfer.setData("sourceType",o.isRowspanGroup?"group":"single")},E=t=>{t.preventDefault()},U=(t,e)=>{t.preventDefault();const o=parseInt(t.dataTransfer.getData("sourceIndex")),s=t.dataTransfer.getData("sourceId"),d=t.dataTransfer.getData("sourceType");if(isNaN(o)||o===e)return;const l=i.value.find(n=>n.id===s);if(!l)return;const b=G.value[e];let g;if(b.isRowspanGroup){const n=i.value.find(O=>O.id===b.groupId);g=(n==null?void 0:n.sortOrder)||1}else{const n=i.value.find(O=>O.id===b.id);g=(n==null?void 0:n.sortOrder)||1}l.sortOrder<g?(i.value.forEach(n=>{n.sortOrder>l.sortOrder&&n.sortOrder<=g&&n.sortOrder--}),l.sortOrder=g):(i.value.forEach(n=>{n.sortOrder>=g&&n.sortOrder<l.sortOrder&&n.sortOrder++}),l.sortOrder=g)},H=()=>{},$=t=>{switch(t){case"핵심역량":return"category-core";case"직무역량":return"category-job";default:return"category-default"}},z=t=>{console.log("상세보기/수정:",t)},B=t=>{console.log("삭제된 행들:",t),t.forEach(e=>{if(e.isRowspanGroup){const o=i.value.findIndex(s=>s.id===e.groupId);if(o!==-1)if(e.isGroupHeader)i.value.splice(o,1);else{const s=i.value[o];s.behaviors.splice(e.subIndex,1),s.behaviors.length===0&&i.value.splice(o,1)}}else{const o=i.value.findIndex(s=>s.id===e.id);o!==-1&&i.value.splice(o,1)}})};return M(i,t=>{console.log("데이터 변경됨:",t.map(e=>({id:e.id,sortOrder:e.sortOrder})))},{deep:!0}),(t,e)=>{const o=j,s=A,d=F;return c(),p("div",null,[h(d,{modelValue:G.value,"onUpdate:modelValue":[e[3]||(e[3]=l=>G.value=l),t.updateTableData],title:"역량항목 구분 (개선된 멀티행 정렬)",bordered:"",scrollable:"",sortable:C.value,editable:"","max-height":"calc(100vh - 200px)",canAddRow:!1,canSave:!1,isDragging:!0,onSort:T,onRowDeleted:B},{"header-action-right":f(()=>[a("div",K,[h(o,{variant:"secondary-line"},{default:f(()=>e[4]||(e[4]=[_("NCS")])),_:1}),h(o,{variant:"secondary-line"},{default:f(()=>e[5]||(e[5]=[_("공통/리더십")])),_:1}),h(o,{variant:"secondary"},{default:f(()=>e[6]||(e[6]=[_("추가")])),_:1})])]),colgroup:f(()=>e[7]||(e[7]=[a("col",{style:{width:"40px"}},null,-1),a("col",{style:{width:"200px"}},null,-1),a("col",{style:{width:"100px"}},null,-1),a("col",{style:{width:"auto"}},null,-1),a("col",{style:{width:"100px"}},null,-1),a("col",{style:{width:"100px"}},null,-1),a("col",{style:{width:"40px"}},null,-1)])),header:f(({selectAll:l,isAllSelected:u})=>[a("th",null,[h(s,{size:"large",onClick:e[0]||(e[0]=k(()=>{},["stop"])),modelValue:u,"onUpdate:modelValue":l},null,8,["modelValue","onUpdate:modelValue"])]),e[8]||(e[8]=a("th",null,"역량정의/역량항목",-1)),e[9]||(e[9]=a("th",null,"구분",-1)),e[10]||(e[10]=a("th",null,"행동기준/행동수준/역량정의",-1)),e[11]||(e[11]=a("th",null,"수준/점수",-1)),e[12]||(e[12]=a("th",null,"가중",-1)),e[13]||(e[13]=a("th",null,"수정",-1))]),body:f(({rows:l,toggleRowSelection:u,isRowSelected:b,handleDragStart:g,handleDragOver:n,handleDrop:O,handleDragEnd:le})=>[(c(!0),p(q,null,J(l,(r,w)=>(c(),p("tr",{key:`${r.groupId||"single"}-${r.id}-${r.subIndex||0}`,class:R(N(r)),draggable:V(r),onDragstart:y=>S(y,w,r),onDragover:e[2]||(e[2]=y=>E(y)),onDrop:y=>U(y,w),onDragend:H},[D(r,"checkbox")?(c(),p("td",{key:0,rowspan:x(r,"checkbox"),class:"txt-c vertical-top checkbox-cell"},[h(s,{size:"large",onClick:e[1]||(e[1]=k(()=>{},["stop"])),modelValue:b(r),"onUpdate:modelValue":()=>u(r)},null,8,["modelValue","onUpdate:modelValue"])],8,W)):m("",!0),D(r,"definition")?(c(),p("td",{key:1,rowspan:x(r,"definition"),class:"vertical-middle"},[r.isRowspanGroup&&r.isGroupHeader?(c(),p("div",Y,[a("strong",null,"["+v(r.competencyName)+"]",1),e[14]||(e[14]=a("br",null,null,-1)),_(" "+v(r.definition),1)])):r.isRowspanGroup?m("",!0):(c(),p("div",Z,[a("span",{class:R(["category-badge",$(r.category)])},v(r.category),3)]))],8,X)):m("",!0),D(r,"type")?(c(),p("td",{key:2,rowspan:x(r,"type"),class:"text-center"},v(r.type),9,ee)):m("",!0),a("td",te,[a("div",{class:R(r.isRowspanGroup?"behavior-rowspan":"behavior-normal")},v(r.behavior),3)]),a("td",oe,v(r.level),1),a("td",re,v(r.weight),1),D(r,"actions")?(c(),p("td",{key:3,rowspan:x(r,"actions")},[h(o,{variant:"ghost",size:"small",onClick:y=>z(r)},{default:f(()=>e[15]||(e[15]=[a("i",{class:"icon icon-md icon-edit"},null,-1)])),_:2},1032,["onClick"])],8,se)):m("",!0)],42,Q))),128))]),_:1},8,["modelValue","sortable","onUpdate:modelValue"])])}}},ge=P(ae,[["__scopeId","data-v-fd11bbd2"]]);export{ge as default};
