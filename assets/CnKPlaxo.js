import M from"./uaojfoPz.js";import q from"./C94CRLMA.js";import{r as p,z,a2 as E,c as s,o,a as r,k as n,t as h,b as v,C as L,I as c,w as g,x as w,d as b,n as F}from"./BzG8mJ5d.js";import"./B_gW8pWf.js";const G={class:"flex items-center gap-10"},J={class:"heading-4"},K={key:0,class:"grade-range-controls flex items-center gap-5 mr-5"},P={key:0,class:"table-actions"},Q={class:"button-group flex items-center gap-5"},W={key:1,class:"excel-controls flex items-center gap-5 mr-5"},X={key:0,class:"sort-mode-message"},Y={key:1,class:"empty-state"},Z={class:"empty-content"},_={class:"empty-title"},ee={class:"empty-description"},te={key:0,class:"empty-actions"},le={key:2,class:"table-scroll-container"},ae={key:0},oe={key:1,class:"sticky-header"},se={key:2},ne={key:3},de={key:0},ie={key:1,class:"sticky-header"},re={key:2},ue={key:3},ce={key:4},ve={__name:"UiTable",props:{title:{type:String,default:""},bordered:{type:Boolean,default:!1},striped:{type:Boolean,default:!0},hover:{type:Boolean,default:!1},size:{type:String,default:"medium",validator:t=>["small","medium","large"].includes(t)},layout:{type:String,default:"vertical",validator:t=>["vertical","horizontal"].includes(t)},isThLeft:{type:Boolean,default:!1},alignTop:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},maxHeight:{type:String,default:"400px"},fixHeader:{type:Boolean,default:!1},modelValue:{type:Array,default:()=>[]},editable:{type:Boolean,default:!1},excelControls:{type:Boolean,default:!1},excelDownloadLabel:{type:String,default:"엑셀 다운로드"},excelUploadLabel:{type:String,default:"엑셀 업로드"},defaultRowData:{type:Object,default:()=>({})},sortableOption:{type:Boolean,default:!1},canAddRow:{type:Boolean,default:!0},canSave:{type:Boolean,default:!0},canAddSortableButton:{type:Boolean,default:!0},gradeRangeControls:{type:Boolean,default:!1},emptyTitle:{type:String,default:"데이터가 없습니다"},emptyDescription:{type:String,default:"표시할 항목이 없습니다."},forceEmpty:{type:Boolean,default:!1},rowClickable:{type:Boolean,default:!1}},emits:["update:modelValue","save","row-added","row-deleted","row-click","order-changed"],setup(t,{emit:O}){const y=O,i=t,d=p([]),u=p(i.sortableOption),k=p(!1),m=p(null),D=z(()=>i.forceEmpty||!i.modelValue||i.modelValue.length===0),S=z(()=>i.modelValue.length>0&&d.value.length===i.modelValue.length),B=()=>{S.value?d.value=[]:d.value=[...i.modelValue]},V=e=>{if(u.value)return;const l=d.value.findIndex(a=>a===e);l===-1?d.value.push(e):d.value.splice(l,1)},$=e=>d.value.includes(e),H=()=>({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...i.defaultRowData}),R=()=>{const e=H(),l=[...i.modelValue,e];y("update:modelValue",l),y("row-added",e)},I=()=>{if(d.value.length===0)return;const e=[...d.value],l=i.modelValue.filter(a=>!d.value.includes(a));y("update:modelValue",l),d.value=[],y("row-deleted",e)},U=()=>{u.value=!u.value,u.value||(d.value=[])},C=(e,l)=>{if(u.value){m.value=l,k.value=!0,e.dataTransfer.effectAllowed="move";try{const a=e.target.closest("tr");a&&e.dataTransfer.setDragImage(a,0,0)}catch(a){console.warn("Drag image not supported in this browser",a)}}},A=e=>{u.value&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},T=(e,l)=>{if(!(!u.value||m.value===null)){if(e.preventDefault(),m.value!==l){const a=[...i.modelValue],f=a[m.value];a.splice(m.value,1),a.splice(l,0,f),y("update:modelValue",a),y("order-changed",{from:m.value,to:l,rows:a})}m.value=null,k.value=!1}},x=()=>{m.value=null,k.value=!1},N=(e,l,a)=>{i.rowClickable&&(a.target.closest(".ui-checkbox")||a.target.closest("button")||a.target.closest(".drag-handle")||y("row-click",{row:e,index:l,event:a}))},j=()=>{y("save",i.modelValue),u.value=!1};return E(()=>i.modelValue,()=>{d.value=d.value.filter(e=>i.modelValue.some(l=>l===e))}),E(()=>i.editable,e=>{e||(u.value=!1)}),(e,l)=>{const a=M,f=q;return o(),s("div",{class:w(["ui-table-wrapper",[t.bordered&&"bordered",t.striped&&"striped",t.hover&&"hover",t.size,t.layout,t.scrollable&&"scrollable",k.value&&"dragging",t.editable&&"editable",t.alignTop&&"align-top"]]),style:F(t.scrollable?{maxHeight:t.maxHeight}:{})},[r("div",{class:w(["section-header flex items-center justify-between",t.fixHeader&&"sticky-header-btn"])},[r("div",G,[r("h2",J,h(t.title),1),t.gradeRangeControls?(o(),s("div",K,[r("div",null,[v(a,{label:"구간대 설정"})])])):n("",!0)]),t.editable?(o(),s("div",P,[r("div",Q,[t.canAddRow?(o(),L(f,{key:0,type:"button",variant:"secondary-line","icon-only":"",onClick:R,title:"행 추가"},{default:g(()=>l[0]||(l[0]=[r("i",{class:"icon-md icon-plus icon-black"},null,-1)])),_:1})):n("",!0),v(f,{type:"button",variant:"secondary-line","icon-only":"",onClick:I,disabled:d.value.length===0,title:"선택한 행 삭제"},{default:g(()=>l[1]||(l[1]=[r("i",{class:"icon-md icon-delete"},null,-1)])),_:1},8,["disabled"]),t.canAddSortableButton?(o(),L(f,{key:1,type:"button",variant:"secondary-line","icon-only":"",onClick:U,class:w({active:u.value}),title:"정렬 모드"},{default:g(()=>l[2]||(l[2]=[r("i",{class:"icon-md icon-sort"},null,-1)])),_:1},8,["class"])):n("",!0),t.canSave?c(e.$slots,"action-button",{key:2},()=>[v(f,{type:"button",variant:"primary",onClick:j},{default:g(()=>l[3]||(l[3]=[b("저장")])),_:1})]):n("",!0)])])):n("",!0),t.excelControls?(o(),s("div",W,[v(f,{variant:"secondary-line",size:"medium"},{default:g(()=>[l[4]||(l[4]=r("i",{class:"icon-md icon-excel"},null,-1)),b(" "+h(t.excelDownloadLabel),1)]),_:1}),v(f,{variant:"secondary-line",size:"medium"},{default:g(()=>[l[5]||(l[5]=r("i",{class:"icon-md icon-excel"},null,-1)),b(" "+h(t.excelUploadLabel),1)]),_:1})])):n("",!0)],2),u.value&&t.editable?(o(),s("div",X,l[6]||(l[6]=[b(" 행을 드래그하여 순서를 변경할 수 있습니다. "),r("br",null,null,-1),b("완료 후 정렬 버튼을 다시 클릭하세요. ")]))):n("",!0),D.value?(o(),s("div",Y,[c(e.$slots,"empty",{addRow:R,editable:t.editable},()=>[r("div",Z,[r("h3",_,h(t.emptyTitle),1),r("p",ee,h(t.emptyDescription),1),t.editable&&t.canAddRow?(o(),s("div",te,[v(f,{variant:"primary",onClick:R},{default:g(()=>l[7]||(l[7]=[r("i",{class:"icon-sm icon-plus"},null,-1),b(" 첫 번째 항목 추가 ")])),_:1})])):n("",!0)])])])):t.scrollable?(o(),s("div",le,[r("table",{class:w(["ui-table",{"th-left":t.isThLeft}])},[e.$slots.colgroup?(o(),s("colgroup",ae,[c(e.$slots,"colgroup")])):n("",!0),e.$slots.header&&t.layout!=="horizontal"?(o(),s("thead",oe,[c(e.$slots,"header",{selectAll:B,isAllSelected:S.value,editable:t.editable})])):n("",!0),e.$slots.body?(o(),s("tbody",se,[c(e.$slots,"body",{rows:t.modelValue,selectedRows:d.value,toggleRowSelection:V,isRowSelected:$,handleDragStart:C,handleDragOver:A,handleDrop:T,handleDragEnd:x,handleRowClick:N,sortable:u.value,editable:t.editable})])):n("",!0),e.$slots.footer?(o(),s("tfoot",ne,[c(e.$slots,"footer")])):n("",!0)],2)])):D.value?n("",!0):(o(),s("table",{key:3,class:w(["ui-table",{"th-left":t.isThLeft}])},[e.$slots.colgroup?(o(),s("colgroup",de,[c(e.$slots,"colgroup")])):n("",!0),e.$slots.header&&t.layout!=="horizontal"?(o(),s("thead",ie,[c(e.$slots,"header",{selectAll:B,isAllSelected:S.value,editable:t.editable})])):n("",!0),t.layout==="horizontal"?(o(),s("thead",re,[c(e.$slots,"header")])):n("",!0),e.$slots.body?(o(),s("tbody",ue,[c(e.$slots,"body",{rows:t.modelValue,selectedRows:d.value,toggleRowSelection:V,isRowSelected:$,handleDragStart:C,handleDragOver:A,handleDrop:T,handleDragEnd:x,sortable:u.value,editable:t.editable})])):n("",!0),e.$slots.footer?(o(),s("tfoot",ce,[c(e.$slots,"footer")])):n("",!0)],2))],6)}}};export{ve as default};
